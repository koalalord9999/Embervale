<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Embrune</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/dexie@3.2.2/dist/dexie.min.js"></script>

    <style>
      html, body, #root {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden; /* Prevents scrollbars if aspect ratio overflows a bit */
      }
      body {
        background-color: #282c34;
        user-select: none; /* Disable text selection */
        -webkit-user-select: none; /* Safari */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* IE */
        -webkit-touch-callout: none; /* iOS Safari - Disable long-press menu */
      }
      /* Re-enable text selection specifically for the activity log text */
      .activity-log-wrapper .text-sm {
        user-select: text;
        -webkit-user-select: text;
        -moz-user-select: text;
        -ms-user-select: text;
      }
      /* Attack Animations */
      .animation-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        overflow: hidden;
        z-index: 10;
      }

      .attack-animation {
        position: absolute;
        will-change: transform;
        pointer-events: none;
      }

      /* --- STAB --- */
      .anim-stab {
        height: 4px;
        background: linear-gradient(to right, rgba(255,255,255,0.2), white, rgba(255,255,255,0.2));
        transform-origin: left center;
        animation: stab-thrust 0.3s ease-out forwards;
      }
      
      @keyframes stab-thrust {
        0% { clip-path: inset(0 100% 0 0); }
        50% { clip-path: inset(0 0 0 0); }
        100% { clip-path: inset(0 0 0 100%); }
      }

      /* --- SLASH --- */
      .anim-slash {
        width: 120px;
        height: 120px;
        animation: slash-arc 0.4s ease-out forwards;
      }
      .anim-slash svg {
        width: 100%;
        height: 100%;
        transform: rotate(100deg); /* Initial rotation adjustment */
      }
      .anim-slash path {
        stroke-dasharray: 200;
        stroke-dashoffset: 200;
        animation: slash-draw 0.4s ease-out forwards;
      }

      @keyframes slash-arc {
        0% { opacity: 1; transform: rotate(-80deg) scale(0.8); }
        100% { opacity: 0; transform: rotate(0deg) scale(1.2); }
      }

      @keyframes slash-draw {
        from { stroke-dashoffset: 200; }
        to { stroke-dashoffset: 0; }
      }

      /* --- CRUSH --- */
      .anim-crush {
        width: 80px;
        height: 80px;
        animation: crush-slam 0.5s ease-out forwards;
      }
      .anim-crush-hammer {
        width: 100%;
        height: 100%;
        background-color: white;
        mask-image: url('https://api.iconify.design/game-icons:hammer-drop.svg');
        mask-size: contain;
        mask-repeat: no-repeat;
        mask-position: center;
      }
      .anim-crush-shockwave {
        position: absolute;
        top: 70%;
        left: 50%;
        width: 10px;
        height: 4px;
        border-radius: 50%;
        border: 2px solid white;
        transform: translate(-50%, -50%);
        opacity: 0;
        animation: crush-shockwave 0.5s 0.2s ease-out forwards;
      }

      @keyframes crush-slam {
        0% { opacity: 0; transform: translateY(-50px) scale(1.5); }
        40% { opacity: 1; transform: translateY(0) scale(1); }
        100% { opacity: 0; transform: translateY(10px) scale(0.9); }
      }

      @keyframes crush-shockwave {
        from { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        to { opacity: 0; transform: translate(-50%, -50%) scale(8); }
      }

      /* --- RANGED --- */
      .anim-ranged svg {
        width: 50px;
        height: 50px;
        filter: drop-shadow(0 0 2px black);
        overflow: visible;
      }
      .arrow-shaft { fill: #8c5a2b; }
      .arrow-feather { fill: #e0e0e0; }
      .arrow-tip-default { fill: #c0c0c0; }
      .arrow-tip-bronze { fill: #cd7f32; }
      .arrow-tip-iron { fill: #a0a0a0; }
      .arrow-tip-steel { fill: #d0d0d0; }
      .arrow-tip-mithril { fill: #97b5d8; }
      .arrow-tip-adamantite { fill: #3a5e4a; }
      .arrow-tip-runic { fill: #7b6d8d; }

      /* --- MAGIC --- */
      .anim-magic {
        --magic-color: white; /* Default color */
        position: relative;
        background-color: var(--magic-color);
        box-shadow: 0 0 15px var(--magic-color), 0 0 25px var(--magic-color);
        animation: magic-fly 0.5s linear forwards;
      }

      /* Trail effect for lower tiers */
      .anim-magic-1::after,
      .anim-magic-2::after {
          content: '';
          position: absolute;
          left: 50%;
          top: 50%;
          width: 250%;
          height: 100%;
          background: linear-gradient(to right, var(--magic-color), transparent);
          border-radius: 50%;
          filter: blur(8px);
          opacity: 0.8;
          z-index: -1;
          transform-origin: left center;
          transform: translate(-25%, -50%);
          animation: magic-trail-fade 0.5s ease-out forwards;
      }

      @keyframes magic-trail-fade {
          from { opacity: 0.8; transform: translate(-25%, -50%) scaleX(1); }
          to { opacity: 0; transform: translate(-25%, -50%) scaleX(0); }
      }

      /* Elemental Colors */
      .element-wind { --magic-color: #00FFFF; } /* cyan */
      .element-water { --magic-color: #1E90FF; } /* dodgerblue */
      .element-earth { --magic-color: #32CD32; } /* limegreen */
      .element-fire { --magic-color: #FFA500; } /* orange */
      
      /* Tier Sizes & Special Animations */
      /* Tier 1 (Dart) - Teardrop shape */
      .anim-magic-1 {
        width: 30px;
        height: 30px;
        border-radius: 50% 50% 50% 0;
      }
      /* Tier 2 (Bolt) - Energetic oval */
      .anim-magic-2 {
        width: 40px;
        height: 25px;
        border-radius: 50%;
        animation-name: magic-fly, magic-pulse;
        animation-duration: 0.5s, 0.2s;
        animation-iteration-count: 1, infinite;
        animation-direction: normal, alternate;
      }
      /* Tier 3 (Blast) - Rotating diamond */
      .anim-magic-3 {
        width: 50px;
        height: 50px;
        border-radius: 0;
        clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
        animation-name: magic-fly, magic-spin;
        animation-duration: 0.5s, 2s;
        animation-iteration-count: 1, infinite;
        animation-timing-function: linear, linear;
      }
      .anim-magic-3::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 40%;
        height: 40%;
        background: white;
        filter: blur(5px);
        border-radius: 50%;
        opacity: 0.8;
      }
      /* Tier 4 (Wave) - Counter-rotating crescents */
      .anim-magic-4 {
        width: 60px;
        height: 60px;
        background: none;
        box-shadow: none;
      }
      .anim-magic-4::before,
      .anim-magic-4::after {
        content: '';
        position: absolute;
        top: 0; left: 0;
        width: 100%; height: 100%;
        border: 4px solid var(--magic-color);
        box-shadow: 0 0 10px var(--magic-color);
        border-radius: 50%;
        clip-path: inset(0 50% 0 0);
        animation-name: magic-fly;
        animation-duration: 0.5s;
        animation-iteration-count: 1;
        animation-timing-function: linear;
      }
      .anim-magic-4::before { animation-name: magic-fly, magic-spin; animation-duration: 0.5s, 1.5s; animation-iteration-count: 1, infinite; animation-timing-function: linear, ease-in-out; }
      .anim-magic-4::after { animation-name: magic-fly, magic-spin-reverse; animation-duration: 0.5s, 1.5s; animation-iteration-count: 1, infinite; animation-timing-function: linear, ease-in-out; }

      /* Tier 5 (Storm) - Chaotic, multi-pronged vortex */
      .anim-magic-5 {
        width: 70px;
        height: 70px;
        background: none;
        box-shadow: none;
        animation: magic-fly 0.5s linear forwards, magic-spin 1s linear infinite;
      }
      .anim-magic-5::before,
      .anim-magic-5::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: var(--magic-color);
        box-shadow: 0 0 15px var(--magic-color);
      }
      .anim-magic-5::before {
        clip-path: polygon(50% 0, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        animation: magic-spin-reverse 1.2s linear infinite;
      }
      .anim-magic-5::after {
        clip-path: polygon(50% 0, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
        animation: magic-spin 0.8s linear infinite;
        transform: scale(0.6) rotate(45deg);
        background-color: white;
        box-shadow: 0 0 15px white;
      }


      @keyframes magic-fly {
          from { opacity: 1; transform: scale(0.5); }
          to { opacity: 1; transform: scale(1); }
      }
      @keyframes magic-pulse {
          from { box-shadow: 0 0 20px var(--magic-color), 0 0 30px var(--magic-color); }
          to { box-shadow: 0 0 25px var(--magic-color), 0 0 40px white, 0 0 50px var(--magic-color); }
      }
      @keyframes magic-spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
      }
      @keyframes magic-spin-reverse {
          from { transform: rotate(0deg); }
          to { transform: rotate(-360deg); }
      }

      /* Hitsplat Styles */
      .hitsplat-container {
        position: absolute;
        width: 5rem;
        height: 5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        pointer-events: none;
        will-change: transform, opacity, top;
        transition: top 0.5s ease-out, opacity 0.5s ease-out, transform 0.2s ease-out;
      }

      .hitsplat-splat {
        position: absolute;
        width: 100%;
        height: 100%;
        mask-image: url('https://api.iconify.design/game-icons:gooey-impact.svg');
        mask-size: contain;
        mask-repeat: no-repeat;
        mask-position: center;
        -webkit-mask-image: url('https://api.iconify.design/game-icons:gooey-impact.svg');
        -webkit-mask-size: contain;
        -webkit-mask-repeat: no-repeat;
        -webkit-mask-position: center;
      }

      .hitsplat-red { background-color: rgb(185, 28, 28); } /* red-700 */
      .hitsplat-blue { background-color: rgb(37, 99, 235); } /* blue-600 */
      .hitsplat-orange { background-color: rgb(234, 88, 12); } /* orange-600 */
      .hitsplat-green { background-color: rgb(22, 163, 74); } /* green-600 */
      .hitsplat-dragonfire { background-color: rgb(255, 130, 20); }

      .hitsplat-text {
        position: relative;
        color: white;
        font-weight: bold;
        font-size: 1.75rem; /* 28px */
        text-shadow: 1px 1px 3px black, -1px -1px 3px black, 1px -1px 3px black, -1px 1px 3px black;
      }

      /* Level Up Animation */
      .level-up-container {
        position: absolute;
        inset: 0;
        pointer-events: none;
        z-index: 100;
        overflow: hidden;
        animation: fade-out-level-up forwards;
      }

      @keyframes fade-out-level-up {
        0%, 80% { opacity: 1; }
        100% { opacity: 0; }
      }

      .level-up-centerpiece {
        position: absolute;
        bottom: 50px; /* Adjusted to make it clip */
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        animation: centerpiece-anim 4s ease-in-out forwards;
      }

      .level-up-centerpiece.max-level {
        animation-duration: 8s;
      }

      @keyframes centerpiece-anim {
        0% { transform: translateX(-50%) scale(0); opacity: 0; }
        10% { transform: translateX(-50%) scale(1.1); opacity: 1; }
        20% { transform: translateX(-50%) scale(1); opacity: 1; }
        80% { transform: translateX(-50%) scale(1); opacity: 1; }
        100% { transform: translateX(-50%) scale(1.5); opacity: 0; }
      }


      .level-up-omega {
        font-family: 'Times New Roman', Times, serif;
        font-size: 300px; /* Increased size */
        font-weight: bold;
        color: #FFD700;
        text-shadow: 0 0 10px #FFD700, 0 0 20px #FF8C00, 0 0 3px black;
        line-height: 1;
      }

      .level-up-centerpiece.max-level .level-up-omega {
          animation: pulse-gold-text 1.5s infinite ease-in-out;
      }

      @keyframes pulse-gold-text {
          0%, 100% {
              color: #FFD700;
              text-shadow: 0 0 10px #FFD700, 0 0 20px #FF8C00, 0 0 3px black;
          }
          50% {
              color: #FFF;
              text-shadow: 0 0 15px #FFF, 0 0 25px #FFD700, 0 0 3px black;
          }
      }

      .level-up-skill-icon {
        position: absolute;
        top: 52%; /* Adjusted for new Omega size */
        left: 50%;
        transform: translate(-50%, -50%);
        width: 70px; /* Increased size */
        height: 70px; /* Increased size */
        filter: invert(1) drop-shadow(0 0 3px black);
      }

      .level-up-text {
        font-size: 56px; /* Increased size */
        font-weight: bold;
        color: white;
        text-shadow: 2px 2px 4px black;
        margin-top: -190px; /* Adjusted to pull text up inside Omega */
      }

      .fireworks-container {
        position: absolute;
        inset: 0;
      }

      .firework {
        position: absolute;
      }

      .firework-particle {
        position: absolute;
        top: 0;
        left: 0;
        border-radius: 50%;
        animation-name: particle-fly, particle-gravity;
        animation-timing-function: ease-out, ease-in;
        animation-fill-mode: forwards;
        will-change: transform, margin-top;
        opacity: 0;
      }

      @keyframes particle-fly {
        0% {
          transform: rotate(var(--angle)) translateY(0) scale(1);
          opacity: 1;
        }
        100% {
          transform: rotate(var(--angle)) translateY(var(--distance)) scale(0);
          opacity: 0;
        }
      }
      
      @keyframes particle-gravity {
        0% {
          margin-top: 0;
        }
        100% {
          margin-top: 160px; /* Adjust this for more/less fall */
        }
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      .animate-fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes pulse-bg {
        0%, 100% { background-color: rgba(202, 138, 4, 0.2); }
        50% { background-color: rgba(202, 138, 4, 0.4); }
      }
      .animate-pulse-bg {
        animation: pulse-bg 2s infinite;
      }
      @keyframes xp-drop {
          0% { transform: translateY(0) scale(0.5); opacity: 0; }
          20% { transform: translateY(-20px) scale(1); opacity: 1; }
          80% { transform: translateY(-25px) scale(1); opacity: 1; }
          100% { transform: translateY(-40px) scale(0.8); opacity: 0; }
      }
      .animate-xp-drop {
          animation: xp-drop 1.5s ease-out forwards;
      }
      @keyframes shatter-fall {
        0% { transform: scale(1); opacity: 1; }
        100% { transform: scale(0) translateY(50px) rotate(90deg); opacity: 0; }
      }
      .animate-shatter-fall {
        animation: shatter-fall 0.5s cubic-bezier(0.6, -0.28, 0.735, 0.045) forwards;
      }
      @keyframes cut-apart-left {
        0% { transform: translateX(0) rotate(0); }
        100% { transform: translateX(-50%) rotate(-10deg); }
      }
      .animate-cut-apart-left {
        animation: cut-apart-left 0.5s ease-out forwards;
      }
      @keyframes cut-apart-right {
        0% { transform: translateX(0) rotate(0); }
        100% { transform: translateX(50%) rotate(10deg); }
      }
      .animate-cut-apart-right {
        animation: cut-apart-right 0.5s ease-out forwards;
      }
      @keyframes yank-up {
        0% { transform: translateY(0); opacity: 1; }
        100% { transform: translateY(-100%); opacity: 0; }
      }
      .animate-yank-up {
        animation: yank-up 0.4s ease-in forwards;
      }
       @keyframes fade-out-slowly {
        0% { opacity: 1; }
        100% { opacity: 0; }
      }
      .animate-fade-out-slowly {
        animation: fade-out-slowly 0.5s ease-out forwards;
      }
      @keyframes spin-slow {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      .animate-spin-slow {
        animation: spin-slow 5s linear infinite;
      }

      @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(3px); }
          50% { transform: translateX(-3px); }
          75% { transform: translateX(3px); }
      }
      .animate-shake {
          animation: shake 0.2s ease-in-out;
      }

      @keyframes pulse-gold-shadow {
        0%, 100% {
          box-shadow: 0 0 12px 3px rgba(251, 191, 36, 0.7); /* Tailwind yellow-400 */
        }
        50% {
          box-shadow: 0 0 20px 8px rgba(251, 191, 36, 0.4);
        }
      }
      .tutorial-highlight-target {
        animation: pulse-gold-shadow 2s infinite ease-in-out;
        border-radius: 0.375rem; /* rounded-md */
        transition: box-shadow 0.3s ease-in-out;
        position: relative;
        z-index: 60; /* Ensure it's above other elements */
      }
      
      @keyframes pulse-red-shadow {
        0%, 100% {
            filter: drop-shadow(0 0 20px rgba(255, 0, 0, 0.7));
        }
        50% {
            filter: drop-shadow(0 0 40px rgba(255, 0, 0, 0.4));
        }
      }
      .dungeon-entrance-highlight {
          animation: pulse-red-shadow 2s infinite ease-in-out;
      }

      @keyframes pulse-blue-orb {
        0%, 100% {
            transform: translate(-50%, -50%) scale(0.9);
            opacity: 0.5;
        }
        50% {
            transform: translate(-50%, -50%) scale(1.3);
            opacity: 0.8;
        }
      }
      .autocast-orb-highlight::before {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          width: 80%;
          height: 80%;
          background-color: rgba(59, 130, 246, 0.6); /* Tailwind blue-500 */
          border-radius: 50%;
          z-index: -1;
          animation: pulse-blue-orb 2s infinite ease-in-out;
      }

      .pixelated-image {
        image-rendering: -moz-crisp-edges; /* Firefox */
        image-rendering: -webkit-crisp-edges; /* Webkit */
        image-rendering: pixelated; /* Standard */
      }
      
      .poisoned-heart-icon {
        filter: invert(50%) sepia(90%) saturate(1000%) hue-rotate(80deg) brightness(1.2) opacity(0.8);
      }
      
      /* New styles for icon-based crafting */
      .crafting-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
          gap: 8px;
      }

      .crafting-slot {
          position: relative;
          width: 100%;
          aspect-ratio: 1 / 1;
          background-color: rgba(0, 0, 0, 0.4);
          border: 2px solid #4a5568; /* gray-700 */
          border-radius: 0.375rem; /* rounded-md */
          cursor: pointer;
          transition: all 0.2s ease-in-out;
          display: flex;
          flex-direction: column;
          justify-content: space-between;
          align-items: center;
          padding: 4px;
      }

      .crafting-slot:hover {
          border-color: #f59e0b; /* yellow-500 */
          transform: translateY(-2px);
      }

      .crafting-slot.disabled {
          cursor: not-allowed;
          filter: grayscale(80%) brightness(0.7);
      }

      .crafting-slot-icon {
          width: 60%;
          height: 60%;
          object-fit: contain;
          margin: auto;
      }

      .crafting-slot-level {
          position: absolute;
          top: 2px;
          left: 2px;
          background-color: rgba(0, 0, 0, 0.7);
          color: white;
          font-size: 0.75rem; /* text-xs */
          font-weight: bold;
          padding: 1px 4px;
          border-radius: 0.25rem; /* rounded-sm */
          line-height: 1;
          z-index: 10;
      }

      .crafting-slot-level.met {
          color: #4ade80; /* green-400 */
      }

      .crafting-slot-level.unmet {
          color: #f87171; /* red-400 */
      }

      .crafting-slot-ingredients {
          display: flex;
          gap: 2px;
          justify-content: center;
          align-items: center;
          width: 100%;
          height: 20px; /* fixed height */
          flex-shrink: 0;
      }

      .ingredient-icon {
          position: relative;
          width: 18px;
          height: 18px;
          background-color: rgba(0, 0, 0, 0.5);
          border: 1px solid #4a5568; /* gray-700 */
          border-radius: 0.25rem; /* rounded-sm */
          display: flex;
          align-items: center;
          justify-content: center;
      }

      .ingredient-icon img {
          width: 14px;
          height: 14px;
      }

      .ingredient-quantity {
          position: absolute;
          bottom: -2px;
          right: -2px;
          font-size: 0.6rem;
          font-weight: bold;
          color: #f59e0b; /* yellow-500 */
          background: rgba(0,0,0,0.8);
          border-radius: 50%;
          padding: 0 2px;
          line-height: 1;
          text-shadow: 1px 1px 1px black;
      }
      
      /* Rotate specific item icons for better presentation */
      /* Apply rotation ONLY to non-noted items */
      img[src*="game-icons:bone-knife"]:not(.item-note-icon) {
        transform: rotate(-90deg);
      }
      img[src*="game-icons:curvy-knife"]:not(.item-note-icon) {
        transform: rotate(-75deg);
      }
      img[src*="game-icons:arrow-flights"]:not(.item-note-icon),
      img[src*="game-icons:arrowhead"]:not(.item-note-icon),
      img[src*="game-icons:broadhead-arrow"]:not(.item-note-icon) {
        transform: rotate(-90deg);
      }
      img[src*="game-icons:key-skeleton"]:not(.item-note-icon) {
        transform: rotate(180deg);
      }
      img[src*="game-icons:key.svg#loop"]:not(.item-note-icon) {
        transform: rotate(180deg);
      }
      
      /* Apply combined transform for noted items that need rotation */
      .item-note-icon[src*="game-icons:bone-knife"] {
        transform: translate(-50%, -50%) rotate(-90deg);
      }
      .item-note-icon[src*="game-icons:curvy-knife"] {
        transform: translate(-50%, -50%) rotate(-75deg);
      }
      .item-note-icon[src*="game-icons:arrow-flights"],
      .item-note-icon[src*="game-icons:arrowhead"],
      .item-note-icon[src*="game-icons:broadhead-arrow"] {
        transform: translate(-50%, -50%) rotate(-90deg);
      }
      .item-note-icon[src*="game-icons:key-skeleton"] {
        transform: translate(-50%, -50%) rotate(180deg);
      }
      .item-note-icon[src*="game-icons:key.svg#loop"] {
        transform: translate(-50%, -50%) rotate(180deg);
      }

      /* Styles for Noted Items & Bank Action Buttons */
      .item-note-wrapper {
          position: relative;
          width: 100%;
          height: 100%;
          overflow: hidden; /* Clips the oversized paper icon */
      }
      .item-note-paper {
          position: absolute;
          width: 100%;
          height: 100%;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) scale(2.2);
          filter: invert(75%) sepia(21%) saturate(300%) hue-rotate(356deg) brightness(95%) contrast(80%); /* Dark tan color */
          opacity: 0.9;
      }
      .item-note-icon {
          position: absolute;
          width: 90%;
          height: 90%;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          z-index: 1;
      }
      .bank-action-bg-icon {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(2.2);
        filter: invert(60%) sepia(80%) saturate(1500%) hue-rotate(80deg) brightness(1.0) contrast(0.9);
        opacity: 0.9;
      }
      .poison-overlay-icon {
        position: absolute;
        top: 2px;
        right: 2px;
        width: 16px;
        height: 16px;
        z-index: 5;
        pointer-events: none;
      }

      /* Bank Tab Styles */
      .bank-tab {
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0.5rem 0.75rem;
        border: 2px solid #4a5568; /* gray-700 */
        background-color: #2d3748; /* gray-800 */
        border-radius: 0.375rem 0.375rem 0 0;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        border-bottom: none;
      }
      .bank-tab:hover {
        background-color: #4a5568; /* gray-700 */
      }
      .bank-tab.active {
        background-color: #1a202c; /* gray-900 */
        border-color: #f59e0b; /* yellow-500 */
        border-bottom: 2px solid #f59e0b;
        transform: translateY(2px);
      }
      .bank-tab-icon {
        width: 3rem; /* 24px */
        height: 3rem; /* 24px */
      }
      .bank-tab-drag-over {
        border-color: #4ade80; /* green-400 */
        background-color: #166534; /* green-800 */
      }

      .bank-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
        gap: 8px;
        overflow-y: auto;
        align-content: start; /* Prevents rows from stretching vertically */
      }

      @media (max-width: 768px) {
        .bank-tabs-container {
            overflow-x: auto;
            /* Hide scrollbar visually but keep functionality */
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .bank-tabs-container::-webkit-scrollbar {
            display: none; /* Safari and Chrome */
        }

        .bank-tab {
            flex-shrink: 0; /* Prevent tabs from shrinking */
            padding: 0.5rem; /* Makes it more square */
        }

        .bank-grid {
            grid-template-columns: repeat(auto-fill, 48px);
            justify-content: center;
            overflow-y: auto;
            padding-right: 4px;
        }
      }

      /* Item Material Colors */
      :root {
        --item-shadow: drop-shadow(1px 1px 0 #222) drop-shadow(-1px -1px 0 #222) drop-shadow(1px -1px 0 #222) drop-shadow(-1px 1px 0 #222);
      }
      .item-icon-default {
        filter: invert(1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-bronze {
        filter: invert(28%) sepia(51%) saturate(1471%) hue-rotate(359deg) brightness(91%) contrast(92%) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-iron {
        filter: invert(75%) sepia(10%) saturate(100%) hue-rotate(180deg) brightness(0.8) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-steel {
        filter: invert(95%) sepia(5%) saturate(50%) hue-rotate(180deg) brightness(1.2) contrast(1.2) var(--item-shadow);
        opacity: 0.85;
      }
       /* New Tier Colors */
      .item-icon-mithril { /* Silvery-blue */
        filter: invert(80%) sepia(20%) saturate(1200%) hue-rotate(180deg) brightness(1.1) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-adamantite { /* Dark green */
        filter: invert(30%) sepia(40%) saturate(800%) hue-rotate(80deg) brightness(0.9) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-runic { /* Greyish-purple */
        filter: invert(60%) sepia(30%) saturate(800%) hue-rotate(220deg) brightness(1.0) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-aquatite { /* Shimmering blue-green for new high-level gear */
        filter: invert(60%) sepia(80%) saturate(1500%) hue-rotate(140deg) brightness(1.1) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      /* Ore Colors */
      .item-icon-copper {
        filter: invert(60%) sepia(80%) saturate(1500%) hue-rotate(350deg) brightness(1.1) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-tin {
        filter: invert(90%) sepia(10%) saturate(100%) hue-rotate(180deg) brightness(1.1) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-iron-ore {
         filter: invert(30%) sepia(50%) saturate(800%) hue-rotate(350deg) brightness(0.8) contrast(0.9) var(--item-shadow);
         opacity: 0.85;
      }
       /* New Ore Colors */
      .item-icon-mithril-ore {
         filter: invert(50%) sepia(30%) saturate(1000%) hue-rotate(180deg) brightness(0.9) contrast(1.0) var(--item-shadow);
         opacity: 0.85;
      }
       .item-icon-adamantite-ore {
         filter: invert(20%) sepia(30%) saturate(600%) hue-rotate(80deg) brightness(0.8) contrast(0.9) var(--item-shadow);
         opacity: 0.85;
      }
       .item-icon-titanium-ore {
         filter: invert(50%) sepia(20%) saturate(500%) hue-rotate(220deg) brightness(0.9) contrast(1.0) var(--item-shadow);
         opacity: 0.85;
      }
      .item-icon-silver {
        filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1.2) contrast(1.2) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-coal {
        filter: invert(20%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1) contrast(1) var(--item-shadow);
        opacity: 0.85;
      }
      /* Food Colors */
      .item-icon-raw-fish { /* Peachy pink for raw shrimp/eel */
        filter: invert(80%) sepia(30%) saturate(1000%) hue-rotate(320deg) brightness(1.2) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-raw-meat { /* Pinkish red for raw meat/chicken */
        filter: invert(40%) sepia(80%) saturate(500%) hue-rotate(320deg) brightness(1) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-cooked-fish { /* Lightly browned/bronze for cooked fish */
        filter: invert(70%) sepia(50%) saturate(800%) hue-rotate(350deg) brightness(1.0) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-cooked-meat { /* Cooked steak/chicken color */
        filter: invert(40%) sepia(30%) saturate(600%) hue-rotate(350deg) brightness(0.9) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-burnt { /* Dark gray/black for all burnt food */
        filter: grayscale(1) brightness(0.6) contrast(0.9) drop-shadow(1px 1px 0 #555) drop-shadow(-1px -1px 0 #555) drop-shadow(1px -1px 0 #555) drop-shadow(-1px 1px 0 #555);
        opacity: 0.85;
      }
      /* Gem Colors */
      .item-icon-sapphire { /* Blue */
        filter: invert(40%) sepia(90%) saturate(1500%) hue-rotate(180deg) brightness(1.2) contrast(1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-uncut-sapphire { /* Darker Blue */
        filter: invert(40%) sepia(90%) saturate(1500%) hue-rotate(180deg) brightness(0.8) contrast(1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-emerald { /* Green */
        filter: invert(50%) sepia(80%) saturate(1500%) hue-rotate(80deg) brightness(1.1) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-uncut-emerald { /* Darker Green */
        filter: invert(50%) sepia(80%) saturate(1500%) hue-rotate(80deg) brightness(0.7) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-ruby { /* Red */
        filter: invert(25%) sepia(80%) saturate(2000%) hue-rotate(330deg) brightness(1.1) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-uncut-ruby { /* Darker Red */
        filter: invert(25%) sepia(80%) saturate(2000%) hue-rotate(330deg) brightness(0.8) contrast(1.1) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-diamond { /* Bright white/light blue */
        filter: invert(95%) sepia(10%) saturate(1000%) hue-rotate(180deg) brightness(1.5) contrast(1.5) drop-shadow(0 0 5px white) var(--item-shadow);
        opacity: 0.9;
      }
      @keyframes pulse-diamond-shadow {
        0%, 100% {
          filter: invert(95%) sepia(10%) saturate(1000%) hue-rotate(180deg) brightness(1.5) contrast(1.5) drop-shadow(0 0 5px white) drop-shadow(0 0 15px #a7f3d0) var(--item-shadow);
        }
        50% {
          filter: invert(95%) sepia(10%) saturate(1000%) hue-rotate(180deg) brightness(1.8) contrast(1.8) drop-shadow(0 0 10px white) drop-shadow(0 0 25px #a7f3d0) var(--item-shadow);
        }
      }
      .item-icon-diamond-charged {
        animation: pulse-diamond-shadow 2s infinite ease-in-out;
      }
      .item-icon-uncut-diamond { /* Darker, less brilliant white/blue */
        filter: invert(90%) sepia(10%) saturate(800%) hue-rotate(180deg) brightness(1.1) contrast(1.2) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-sunstone { /* Fiery orange/yellow */
        filter: invert(75%) sepia(90%) saturate(1800%) hue-rotate(10deg) brightness(1.2) contrast(1.1) var(--item-shadow);
        opacity: 0.9;
      }
      .item-icon-uncut-sunstone { /* Duller orange/yellow */
        filter: invert(75%) sepia(80%) saturate(1500%) hue-rotate(10deg) brightness(0.9) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-tenebrite { /* Deep void purple/black */
        filter: invert(10%) sepia(20%) saturate(1500%) hue-rotate(240deg) brightness(1.6) contrast(1.2) drop-shadow(1px 1px 0 #555) drop-shadow(-1px -1px 0 #555) drop-shadow(1px -1px 0 #4c1d95) drop-shadow(-1px 1px 0 #4c1d95);
        opacity: 0.9;
      }
      .item-icon-uncut-tenebrite { /* Duller void purple/black */
        filter: invert(15%) sepia(20%) saturate(1200%) hue-rotate(240deg) brightness(0.8) contrast(1.1) drop-shadow(1px 1px 0 #555) drop-shadow(-1px -1px 0 #555) drop-shadow(1px -1px 0 #4c1d95) drop-shadow(-1px 1px 0 #4c1d95);
        opacity: 0.85;
      }
      .item-icon-gold { /* Gold color */
        filter: invert(80%) sepia(50%) saturate(1500%) hue-rotate(10deg) brightness(1.1) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      /* Wood Colors */
      .item-icon-wood-normal { /* Standard brown */
        filter: invert(40%) sepia(50%) saturate(600%) hue-rotate(350deg) brightness(0.9) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-oak { /* Darker, richer brown */
        filter: invert(30%) sepia(40%) saturate(800%) hue-rotate(350deg) brightness(0.8) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-willow { /* Lighter, greenish-brown */
        filter: invert(70%) sepia(30%) saturate(500%) hue-rotate(40deg) brightness(1.0) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-feywood { /* Dark lilac/purple */
        filter: invert(50%) sepia(30%) saturate(1500%) hue-rotate(240deg) brightness(0.9) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-yew { /* Deep, reddish-brown */
        filter: invert(25%) sepia(60%) saturate(900%) hue-rotate(340deg) brightness(0.8) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-driftwood { /* Pale grey */
        filter: invert(90%) sepia(5%) saturate(100%) hue-rotate(180deg) brightness(1.2) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wood-mahogany { /* Rich red-brown */
        filter: invert(30%) sepia(70%) saturate(1200%) hue-rotate(330deg) brightness(0.9) contrast(1.0) var(--item-shadow);
        opacity: 0.85;
      }
      /* Other materials */
      .item-icon-leather { /* Greenish Brown */
        filter: invert(40%) sepia(20%) saturate(800%) hue-rotate(40deg) brightness(0.9) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-wizard-blue { /* Blue for wizard robes */
        filter: invert(40%) sepia(90%) saturate(1500%) hue-rotate(180deg) brightness(1.2) contrast(1) var(--item-shadow);
        opacity: 0.85;
      }

      /* Herblore & Potion Colors */
      .item-icon-grimy-herb { /* dark olive green */
        filter: invert(40%) sepia(30%) saturate(300%) hue-rotate(50deg) brightness(0.7) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-clean-herb { /* bright olive green */
        filter: invert(70%) sepia(50%) saturate(800%) hue-rotate(50deg) brightness(1.1) contrast(0.9) var(--item-shadow);
        opacity: 0.85;
      }
      .item-icon-unfinished-potion { /* murky olive green, tinted glass */
        filter: invert(85%) sepia(80%) saturate(400%) hue-rotate(50deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-vial { /* clear glass */
        filter: invert(85%) sepia(5%) saturate(50%) hue-rotate(180deg) brightness(1.0) contrast(1.0);
        opacity: 0.25;
      }
      .item-icon-vial-water { /* blue tinted glass */
        filter: invert(85%) sepia(100%) saturate(1500%) hue-rotate(160deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }

      /* Potion Palette - Tinted Glass Style */
      .item-icon-potion-weak-attack { /* Paler red */
        filter: invert(85%) sepia(80%) saturate(500%) hue-rotate(330deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion, /* Default (red) */
      .item-icon-potion-attack {
        filter: invert(85%) sepia(100%) saturate(1000%) hue-rotate(330deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-super-attack {
        filter: invert(85%) sepia(100%) saturate(2000%) hue-rotate(330deg) brightness(1.1) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-weak-strength { /* Paler Orange/Copper */
        filter: invert(85%) sepia(80%) saturate(500%) hue-rotate(350deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-strength { /* Orange/Copper */
        filter: invert(85%) sepia(100%) saturate(1000%) hue-rotate(350deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-super-strength {
         filter: invert(85%) sepia(100%) saturate(2000%) hue-rotate(350deg) brightness(1.1) contrast(1.1);
         opacity: 0.85;
      }
      .item-icon-potion-weak-defence { /* Paler Blue */
        filter: invert(85%) sepia(80%) saturate(500%) hue-rotate(180deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-defence { /* Blue */
        filter: invert(85%) sepia(100%) saturate(1000%) hue-rotate(180deg) brightness(1.0) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-super-defence {
         filter: invert(85%) sepia(100%) saturate(2000%) hue-rotate(180deg) brightness(1.1) contrast(1.1);
         opacity: 0.85;
      }
      .item-icon-potion-weak-ranged { /* Paler Green/Brown */
        filter: invert(85%) sepia(80%) saturate(300%) hue-rotate(40deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-ranged { /* Green/Brown */
        filter: invert(85%) sepia(100%) saturate(600%) hue-rotate(40deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-super-ranged {
         filter: invert(85%) sepia(100%) saturate(1500%) hue-rotate(40deg) brightness(1.0) contrast(1.0);
         opacity: 0.85;
      }
      .item-icon-potion-weak-magic { /* Paler Purple */
         filter: invert(85%) sepia(80%) saturate(400%) hue-rotate(220deg) brightness(1.0) contrast(1.1);
         opacity: 0.85;
      }
      .item-icon-potion-magic { /* Purple */
         filter: invert(85%) sepia(100%) saturate(800%) hue-rotate(220deg) brightness(1.0) contrast(1.1);
         opacity: 0.85;
      }
      .item-icon-potion-super-magic {
          filter: invert(85%) sepia(100%) saturate(2000%) hue-rotate(220deg) brightness(1.1) contrast(1.1);
          opacity: 0.85;
      }
      .item-icon-potion-antipoison { /* Bright Green */
        filter: invert(85%) sepia(100%) saturate(1500%) hue-rotate(80deg) brightness(1.0) contrast(1.0);
        opacity: 0.85;
      }
       .item-icon-potion-super-antipoison {
         filter: invert(85%) sepia(100%) saturate(4000%) hue-rotate(80deg) brightness(1.1) contrast(1.0);
         opacity: 0.85;
      }
      .item-icon-potion-poison { /* Dark, murky green */
        filter: invert(85%) sepia(100%) saturate(1000%) hue-rotate(100deg) brightness(0.7) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-restore { /* Yellow/Gold */
        filter: invert(85%) sepia(100%) saturate(1500%) hue-rotate(10deg) brightness(1.1) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-prayer { /* Light Blue */
        filter: invert(85%) sepia(80%) saturate(1200%) hue-rotate(180deg) brightness(1.1) contrast(1.1);
        opacity: 0.85;
      }
       /* Generic skilling potions */
      .item-icon-potion-weak-mining, .item-icon-potion-weak-smithing {
        filter: invert(85%) sepia(15%) saturate(80%) hue-rotate(180deg) brightness(0.9) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-mining, .item-icon-potion-smithing { /* Grey */
        filter: invert(85%) sepia(20%) saturate(100%) hue-rotate(180deg) brightness(0.9) contrast(1.1);
        opacity: 0.85;
      }
      .item-icon-potion-weak-woodcutting, .item-icon-potion-weak-fletching, .item-icon-potion-weak-crafting {
        filter: invert(85%) sepia(80%) saturate(200%) hue-rotate(350deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-woodcutting, .item-icon-potion-fletching, .item-icon-potion-crafting { /* Brown */
        filter: invert(85%) sepia(100%) saturate(400%) hue-rotate(350deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-weak-fishing {
         filter: invert(85%) sepia(80%) saturate(800%) hue-rotate(160deg) brightness(1.1) contrast(1.0);
         opacity: 0.85;
      }
      .item-icon-potion-fishing { /* Bright Blue */
         filter: invert(85%) sepia(100%) saturate(1500%) hue-rotate(160deg) brightness(1.1) contrast(1.0);
         opacity: 0.85;
      }
      .item-icon-potion-weak-herblore {
        filter: invert(85%) sepia(80%) saturate(300%) hue-rotate(240deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      .item-icon-potion-herblore, .item-icon-potion-combo { /* Indigo */
        filter: invert(85%) sepia(100%) saturate(600%) hue-rotate(240deg) brightness(0.9) contrast(1.0);
        opacity: 0.85;
      }
      
      /* Rune Colors */
      .item-icon-rune-gust { filter: invert(90%) sepia(5%) saturate(100%) hue-rotate(180deg) brightness(1.2) contrast(0.9); opacity: 0.9; }
      .item-icon-rune-binding { filter: invert(80%) sepia(30%) saturate(1000%) hue-rotate(240deg) brightness(1.1) contrast(1.0); opacity: 0.9; }
      .item-icon-rune-stone { filter: invert(40%) sepia(50%) saturate(600%) hue-rotate(350deg) brightness(0.9) contrast(0.9); opacity: 0.9; }
      .item-icon-rune-aqua { filter: invert(60%) sepia(80%) saturate(1500%) hue-rotate(140deg) brightness(1.1) contrast(0.9); opacity: 0.9; }
      .item-icon-rune-ember { filter: invert(50%) sepia(80%) saturate(1500%) hue-rotate(330deg) brightness(1.2) contrast(1.1); opacity: 0.9; }
      .item-icon-rune-flux { filter: invert(20%) sepia(80%) saturate(1500%) hue-rotate(330deg) brightness(0.9) contrast(1.1); opacity: 0.9; }
      .item-icon-rune-verdant { filter: invert(60%) sepia(80%) saturate(1500%) hue-rotate(80deg) brightness(1.0) contrast(0.9); opacity: 0.9; }
      .item-icon-rune-nexus { filter: invert(10%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1) contrast(1) drop-shadow(1px 1px 0 #555) drop-shadow(-1px -1px 0 #555) drop-shadow(1px -1px 0 #555) drop-shadow(-1px 1px 0 #555); opacity: 0.9;}
      .item-icon-rune-hex { filter: invert(30%) sepia(40%) saturate(800%) hue-rotate(240deg) brightness(0.8) contrast(0.9); opacity: 0.9; }
      .item-icon-rune-passage { filter: invert(80%) sepia(50%) saturate(1000%) hue-rotate(180deg) brightness(1.2) contrast(1.1); opacity: 0.9; }
      .item-icon-rune-anima { filter: invert(25%) sepia(80%) saturate(2000%) hue-rotate(330deg) brightness(1.1) contrast(1.1); opacity: 0.9; }
      .item-icon-rune-astral { filter: invert(100%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(1.2) contrast(1.2); opacity: 0.9; }
      .item-icon-rune-aether { filter: invert(80%) sepia(80%) saturate(1500%) hue-rotate(100deg) brightness(1.2) contrast(1.1); opacity: 0.9; }

    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "path": "https://aistudiocdn.com/path@^0.12.7",
    "vite": "https://aistudiocdn.com/vite@^7.2.4",
    "@vitejs/plugin-react": "https://aistudiocdn.com/@vitejs/plugin-react@^5.1.1",
    "react-dom": "https://aistudiocdn.com/react-dom@^19.2.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>